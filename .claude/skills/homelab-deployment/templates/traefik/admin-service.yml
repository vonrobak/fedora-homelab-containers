# Traefik route fragment for appending to routers.yml
# Admin service (STRICT security + IP whitelist)
# Append router under http.routers: and service under http.services:

    # {{SERVICE_NAME}} (admin - strict security)
    {{SERVICE_NAME}}-secure:
      rule: "Host(`{{HOSTNAME}}`)"
      entryPoints:
        - websecure
      service: "{{SERVICE_NAME}}"
      middlewares:
        - crowdsec-bouncer@file         # 1. Block bad IPs
        - admin-whitelist@file           # 2. IP whitelist (LAN + VPN only)
        - rate-limit-strict@file         # 3. Strict rate limiting
        - authelia@file                  # 4. SSO authentication
        - security-headers-strict@file   # 5. Strict security headers
      tls:
        certResolver: letsencrypt

# Append under http.services:
    {{SERVICE_NAME}}:
      loadBalancer:
        servers:
          - url: "http://{{SERVICE_NAME}}:{{PORT}}"
